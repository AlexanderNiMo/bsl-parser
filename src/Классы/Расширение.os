///////////////////////////////////////////////////////////////////////////////
//
// Описание модуля
//
///////////////////////////////////////////////////////////////////////////////

Перем ОписаниеКонфигурации;
Перем СтруктураКаталогов;
Перем ПараметрыЧтения;
Перем ПараметрыЗаписи;

///////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС
///////////////////////////////////////////////////////////////////////////////

Процедура ПрочитатьСтруктуру() Экспорт
	
	ЧтениеКонфигурации.ПрочитатьСтруктуруКонфигурации(ПараметрыЧтения);
	ПараметрыЗаписи.Изменения.ИзмененКорневойОбъект = Ложь;
	
КонецПроцедуры

Функция ДобавитьОбъект(Тип, ОписаниеОбъекта) Экспорт
	
	ОбъектКонфигурации = РедакторКонфигурации.ДобавитьОбъект(ОписаниеКонфигурации, Тип, ОписаниеОбъекта);

	ЗаписьКонфигурации.СохранитьОписание(ОбъектКонфигурации);
	
	Возврат ОбъектКонфигурации;
	
КонецФункции

Функция ДобавитьОбъектВРасширение(ОбъектРодительскойКонфигурации) Экспорт
	
	ОбъектКонфигурации = РедакторРасширения.ДобавитьОбъектВРасширение(ОписаниеКонфигурации, ОбъектРодительскойКонфигурации);

	ЗаписьКонфигурации.СохранитьОписание(ОбъектКонфигурации);
	
	Возврат ОбъектКонфигурации;
	
КонецФункции

Процедура Зафиксировать() Экспорт
	
	ЗаписьКонфигурации.Зафиксировать(ПараметрыЗаписи);
	
КонецПроцедуры

// Возвращает описание конфигурации
//
//  Возвращаемое значение:
//   Структура - Описание конфигурации
//
Функция ОписаниеКонфигурации() Экспорт
	
	Возврат ОписаниеКонфигурации;

КонецФункции

Функция СтруктураКаталогов() Экспорт
	
	Возврат СтруктураКаталогов;
	
КонецФункции

Функция ПараметрыЧтения() Экспорт
	
	Возврат ПараметрыЧтения;
	
КонецФункции

Функция ПараметрыЗаписи() Экспорт
	
	Возврат ПараметрыЗаписи;
	
КонецФункции

///////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ
///////////////////////////////////////////////////////////////////////////////

Процедура ПриСозданииОбъекта(пСтруктураКаталогов)
	
	ОписаниеКонфигурации = Новый ДанныеКонфигурации(ЭтотОбъект);
	СтруктураКаталогов = пСтруктураКаталогов;

	ПараметрыЧтения = ЧтениеКонфигурации.СоздатьПараметрыЧтения(ЭтотОбъект, "Extension");
	ПараметрыЗаписи = ЗаписьКонфигурации.СоздатьПараметрыЗаписи(ЭтотОбъект, "Extension");
	ПараметрыЗаписи.Изменения.ИзмененКорневойОбъект = Истина;

КонецПроцедуры
